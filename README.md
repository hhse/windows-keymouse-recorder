# Windows键鼠录制工具

这是一个功能强大的Windows键鼠录制和回放工具，可以帮助您自动化重复性的键鼠操作。

## 功能特点

### 基础版功能 (Tkinter界面)
- ✅ 录制鼠标点击和移动
- ✅ 录制键盘输入
- ✅ 保存和加载录制文件
- ✅ 简单的GUI界面
- ✅ 实时显示录制状态

### 高级版功能 (Tkinter界面)
- ✅ 所有基础版功能
- ✅ 精确的时间控制
- ✅ 全局热键支持 (F9/F10/F11)
- ✅ 更详细的录制信息
- ✅ 紧急停止功能
- ✅ 可自定义热键设置

### PyQt6版功能 (现代化界面)
- ✅ 所有高级版功能
- ✅ 现代化美观的界面
- ✅ 标签页式布局
- ✅ 进度条显示
- ✅ 更好的用户体验
- ✅ 循环回放功能
- ✅ 回放设置选项

## 安装要求

### Python版本
- Python 3.7 或更高版本

### 依赖包
```bash
pip install -r requirements.txt
```

或者运行安装脚本：
```bash
install.bat
```

### 主要依赖
- `PyQt6` - 现代化GUI界面
- `pyautogui` - 自动化鼠标键盘操作
- `keyboard` - 键盘事件监听
- `mouse` - 鼠标事件监听
- `pynput` - 更精确的输入监听

## 快速开始

### 方法1: 使用批处理文件 (推荐)
1. 双击运行 `install.bat` 安装依赖
2. 双击运行 `启动录制工具.bat` 启动程序

### 方法2: 命令行启动
```bash
python start.py
```

## 使用方法

### 1. 启动程序
选择您喜欢的版本：
- **基础版**: 适合初学者，界面简单
- **高级版**: 功能更强大，支持热键控制
- **PyQt6版**: 现代化界面，最佳用户体验

### 2. 录制操作
1. 点击"开始录制"按钮或按F9
2. 执行您要录制的键鼠操作
3. 再次点击按钮或按F9停止录制

### 3. 回放操作
1. 点击"开始回放"按钮或按F10
2. 程序会倒计时3秒后开始回放
3. 可以随时按F11紧急停止

### 4. 保存和加载
- **保存录制**: 将录制的操作保存为JSON文件
- **加载录制**: 从JSON文件加载之前保存的录制

## 热键说明

### 全局热键
- **F9**: 开始/停止录制
- **F10**: 开始/停止回放
- **F11**: 紧急停止所有操作

### PyQt6版额外功能
- **循环回放**: 可以设置重复次数
- **进度显示**: 实时显示回放进度
- **标签页界面**: 更好的功能组织

## 文件说明

- `keymouse_recorder.py` - 基础版录制工具 (Tkinter)
- `advanced_recorder.py` - 高级版录制工具 (Tkinter)
- `qt_recorder.py` - PyQt6版录制工具 (现代化界面)
- `start.py` - 启动脚本
- `启动录制工具.bat` - Windows批处理启动文件
- `install.bat` - 自动安装依赖脚本
- `requirements.txt` - 依赖包列表
- `README.md` - 说明文档

## 录制文件格式

录制的操作以JSON格式保存，包含以下信息：
```json
[
  {
    "type": "mouse_click",
    "x": 100,
    "y": 200,
    "button": "Button.left",
    "pressed": true,
    "time": 1.234
  },
  {
    "type": "key_press",
    "key": "Key.enter",
    "time": 1.456
  }
]
```

## 使用技巧

### 1. 录制前的准备
- 确保目标窗口处于正确位置
- 关闭不必要的程序
- 测试一下要录制的操作流程

### 2. 录制时的注意事项
- 操作要稳定，避免意外点击
- 可以分段录制复杂操作
- 注意时间间隔的合理性

### 3. 回放时的安全
- 确保目标窗口位置正确
- 准备好紧急停止的方法 (F11)
- 可以先在小范围测试

### 4. 文件管理
- 给录制的文件起有意义的名字
- 定期备份重要的录制文件
- 可以创建不同场景的录制库

### 5. PyQt6版特色功能
- 使用标签页组织功能
- 进度条显示回放进度
- 循环回放功能
- 更美观的界面设计

## 常见问题

### Q: 程序无法启动
A: 请检查Python版本和依赖包是否正确安装

### Q: 录制不准确
A: 尝试使用高级版或PyQt6版，它们提供更精确的录制功能

### Q: 回放时位置不对
A: 确保目标窗口位置与录制时一致

### Q: 热键不响应
A: 检查是否有其他程序占用了热键

### Q: 程序崩溃
A: 使用F11紧急停止，然后重新启动程序

### Q: PyQt6版本界面显示异常
A: 确保PyQt6正确安装，可能需要重启程序

## 安全提醒

⚠️ **重要提醒**:
- 本工具仅用于合法的自动化操作
- 请勿用于游戏作弊或其他违规行为
- 使用前请确保符合相关法律法规
- 建议在测试环境中先验证效果

## 技术支持

如果遇到问题，请检查：
1. Python版本是否符合要求
2. 依赖包是否正确安装
3. 是否有权限问题
4. 防火墙是否阻止了程序

## 更新日志

### v1.1.0
- 添加PyQt6现代化界面版本
- 改进用户界面和用户体验
- 添加循环回放功能
- 添加进度条显示
- 优化文件组织结构

### v1.0.0
- 基础版功能实现
- 高级版功能实现
- 热键支持
- GUI界面优化

---

**注意**: 使用本工具时请遵守相关法律法规，仅用于合法的自动化操作。 